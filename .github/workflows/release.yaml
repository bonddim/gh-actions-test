---
name: Release

on:
  push:
    tags:
      - '*'
    # branches:
    #   - 'main'
env:
  GIT_TAG_GLOBAL: "${GITHUB_REF##*/}"

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: |
          echo "GIT_TAG=${GITHUB_REF##*/}" >> $GITHUB_ENV
          echo ${{ env.GIT_TAG_GLOBAL }}
          echo ${{ env.GIT_TAG_STEP }}
          echo ${{ env.GIT_TAG }}
          date > generated.txt
          git config user.name github-actions
          git config user.email github-actions@github.com
          git commit -m "Update" generated.txt
          git tag --force latest
          # git push origin HEAD:main --force --follow-tags --tags
        env:
          GIT_TAG_STEP: "${GITHUB_REF##*/}"
