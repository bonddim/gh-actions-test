---
name: Release

on:
  push:
    tags:
      - '*'
    # branches:
    #   - 'main'
env:
  GIT_TAG: "${GITHUB_REF##*/}"

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: |
          sed -ei 's/^version: .*/version: ${{ env.GIT_TAG }}/' file
          git config user.name github-actions
          git config user.email github-actions@github.com
          git commit -m "Update" file
          git tag --force latest
          git push origin HEAD:main --force --follow-tags --tags
        shell: bash
